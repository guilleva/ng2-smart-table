{"version":3,"file":"title.component.js","sourceRoot":"","sources":["../../../../../../src/ng2-smart-table/components/thead/cells/title/title.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input, Output, EventEmitter, OnInit } from '@angular/core';\n\nimport { DataSource } from '../../../../lib/data-source/data-source';\nimport { Column } from '../../../../lib/data-set/column';\nimport { CompleterService, CompleterData, CompleterItem } from 'ng2-completer';\n\n@Component({\n  selector: 'ng2-smart-table-title',\n  styleUrls: ['./title.component.scss'],\n  template: `\n    <div *ngIf=\"column.options\">\n          <ng2-completer\n            (selected)=\"columnSelected($event)\"\n            [datasource]=\"dataService\"\n            [(ngModel)]=\"selectedOption\"\n            placeholder=\"Set column name\"\n            [minSearchLength]=\"0\"></ng2-completer>\n    </div>\n\n    <a href=\"#\" *ngIf=\"!column.options && column.isSortable\"\n                (click)=\"_sort($event, column)\"\n                class=\"ng2-smart-sort-link sort\"\n                [ngClass]=\"currentDirection\">\n      <div *ngIf=\"column.title\">{{ column.title }}</div>\n    </a>\n    <span class=\"ng2-smart-sort\" *ngIf=\"!column.options && !column.isSortable\">{{ column.title }}</span>\n  `\n})\nexport class TitleComponent implements OnInit {\n  currentDirection = '';\n  @Input() column: Column;\n  @Input() source: DataSource;\n  @Output() sort = new EventEmitter<any>();\n  @Output() autompleteSelect = new EventEmitter<any>();\n  protected dataService: CompleterData;\n\n  protected selectedOption: string;\n\n  constructor(private completerService: CompleterService) { }\n\n  ngOnInit() {\n    if (this.column.options) {\n      this.selectedOption = this.column.title;\n      this.dataService = this.completerService.local(this.column.options, 'title', 'title');\n    }\n    this.source.onChanged().subscribe((elements) => {\n      const sortConf = this.source.getSort();\n\n      if (sortConf.length > 0 && sortConf[0]['field'] === this.column.id) {\n        this.currentDirection = sortConf[0]['direction'];\n      } else {\n        this.currentDirection = '';\n      }\n\n      sortConf.forEach((fieldConf: any) => {\n\n      });\n    });\n  }\n\n  columnSelected(selectedItem: CompleterItem) {\n    if (selectedItem && selectedItem.originalObject) {\n      const oldKey = this.column.id;\n      const newKey = selectedItem.originalObject.value;\n      if (oldKey !== newKey) {\n        this.source.renameColumn(oldKey, newKey);\n        this.autompleteSelect.emit({column: this.column,  selectedItem });\n      }\n    }\n  }\n\n  _sort(event: any) {\n    event.preventDefault();\n    this.changeSortDirection();\n    this.source.setSort([\n      {\n        field: this.column.id,\n        direction: this.currentDirection,\n        compare: this.column.getCompareFunction(),\n      },\n    ]);\n    this.sort.emit(null);\n  }\n\n  changeSortDirection(): string {\n    if (this.currentDirection) {\n      const newDirection = this.currentDirection === 'asc' ? 'desc' : 'asc';\n      this.currentDirection = newDirection;\n    } else {\n      this.currentDirection = this.column.sortDirection;\n    }\n    return this.currentDirection;\n  }\n}\n"]}